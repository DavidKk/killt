// oTemplate.min.js#1.0.0-beta - 2015-12-13 23:34:11
~function(a){"use strict";function b(a){return function(c){switch(a){case"Undefined":return"undefined"==typeof c;case"Defined":return"undefined"!=typeof c;case"Integer":var d=parseInt(c,10);return!isNaN(d)&&c===d&&c.toString()===d.toString();case"PlainObject":var e,f;return!1===b("Object")(c)||b("Undefined")(c)?!1:(e=c.constructor,"function"!=typeof e?!1:(f=e.prototype,!1===b("Object")(f)?!1:!1===f.hasOwnProperty("isPrototypeOf")?!1:!0));default:return"[object "+a+"]"===Object.prototype.toString.call(c)}}}function c(a,b){return(a.substr(0,b).match(/\n/g)||[]).length+1}function d(a){return f(a).replace(/^\s+|\s+$/,"")}function e(a,c){var d=arguments[2];if(void 0===d&&(d="."),b("String")(c)){for(var e=(f=[a,c.split(d)])[0],f=f[1],g=(h=[0,f.length])[0],h=h[1];h>g;g++){if(b("Undefined")(e[f[g]]))return;e=e[f[g]]}return b("Undefined")(e)?void 0:e}}function f(a){return b("String")(a)?a:b("Number")(a)?a+="":b("Function")(a)?f(a.call(a)):""}function g(){var a=arguments[0];return void 0===a&&(a=""),a.replace(/("|'|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")}function h(a){return f(a).replace(/&(?![\w#]+;)|[<>"']/g,h.escapeFn)}function i(a,c,d){for(var e=b("Object")(c)?c[d]:c,f=(g=[0,a.length])[0],g=g[1];g>f;f++)if(e==a[f][d])return f;return-1}function j(a){var c=arguments[1];if(void 0===c&&(c=new Function),b("Function")(c))if(b("Array")(a))if(Array.prototype.some)a.some(c);else for(var d=(e=[0,a.length])[0],e=e[1];e>d&&!0!==c(a[d],d);d++);else if(b("Object")(a))for(var f in a)if(!0===c(a[f],f))break}function k(a){for(var b=(c=[{},[]])[0],c=c[1],d=a.length;d--;)b.hasOwnProperty(a[d])||(c.push(a[d]),b[a[d]]=1);return c}function l(a){var c=arguments[1];void 0===c&&(c=new Function);var d=b("Array")(a),e=d?[]:{};return j(a,function(a,b){c(a,b)&&(e[d?e.length:b]=a)}),e}function m(){var a=Array.prototype.slice,c=a.call(arguments,0),d=(e=[c[0],c[1]])[0],e=e[1];if(c.length>2){d=m(d,e);var f=Array.prototype.slice.call(c,2);return m.apply({},[d].concat(f))}if(b("Array")(d)&&b("Array")(e))Array.prototype.splice.apply(d,[d.length,0].concat(e));else if(b("Object")(d)&&b("Object")(e))if(b("Function")(Object.assign))d=Object.assign(d,e);else for(var g in e)d[g]=e[g];return d}function n(a,c){function d(a){setTimeout(function(){throw a})}var e="";return b("Object")(a)?j(a,function(a,b){e+="<"+b.substr(0,1).toUpperCase()+b.substr(1)+">\n"+a+"\n\n"}):b("String")(a)&&(e=a),"log"===c?b("Defined")(console)&&b("Function")(console.error)?console.error(e):d(e):"catch"===c&&d(e),e}function o(){return""}function p(a,c,d){var e=(f=[window.define,c(d)])[0],f=f[1];b("Function")(e)?e(function(){return f}):"object"==typeof exports?f.exports=f:d[a]=f}var q=function(){function a(){var c=arguments[0];void 0===c&&(c={});var d=this;this._caches={},this._blocks={},this._blockHelpers={},this._sourceHelpers={},this._helpers={},this.DEFAULTS={},this._listeners=[],~m(this.DEFAULTS,a.DEFAULTS,c),~m(this._helpers,{$escape:function(){return h.apply(h,arguments)},$noescape:function(a){return f(a)},$toString:function(a,c){a=f(a);var e=d.DEFAULTS;return!0===(b("Boolean")(c)?c:e.escape)?d.helper("$escape")(a):a},include:function(a){var b=arguments[1];void 0===b&&(b={});var c=arguments[2];void 0===c&&(c={});var e=(d.DEFAULTS,document.getElementById(a));return e?(d.$$throw({message:"[Include Error]: Template ID "+a+" is not found."}),""):d.render(e.innerHTML,b,c)}}),b("Array")(a._extends)&&j(a._extends,function(a){d["extends"](a)})}var c=(function(a,b){return a.__proto__={a:b},a.a===b}({},{}),Object.defineProperty),d=Object.getOwnPropertyDescriptor,e=function(a,b){for(var e in b)b.hasOwnProperty(e)&&c(a,e,d(b,e));return a},g={},k={};return c(a,"prototype",{configurable:!1,enumerable:!1,writable:!1}),k.$$throw=function(b){var c=arguments[1];void 0===c&&(c={});var d=m({},this.DEFAULTS,c),e=n(b,d.env===a.ENV.UNIT?"null":"log");j(this._listeners,function(a){"error"===a.type&&a.handle(e)})},k.$$cache=function(a,b){var c=this._caches;return arguments.length>1?(c[a]=b,this):c[a]},k.on=function(a,c){return b("String")(a)&&b("Function")(c)&&this._listeners.push({type:a,handle:c}),this},k.off=function(a){if(b("Function")(a))var c=i(this._listeners,a,"handle")-1!==c&&this._listeners.splice(c,1);return this},k.onError=function(a){return this.on("error",a)},k.OTemplate=function(b){return new a(b)},k["extends"]=function(a){return a.call(this,this),this},k.config=function(a,c){if(1<arguments.length&&b("String")(a))return"openTag"===a&&"<%"===a||"closeTag"===a&&"%>"===a?this:(this.DEFAULTS[a]=c,this);var d=this;return b("PlainObject")(a)?(j(a,function(a,b){d.config(a,b)}),this):b("String")(a)?this.DEFAULTS[a]:void 0},k.helper=function(a,c){if(1<arguments.length)b("String")(a)&&b("Function")(c)&&(this._helpers[a]=c);else{if(b("String")(a))return this._helpers[a];if(b("PlainObject")(a))for(var d in a)this.helper(d,a[d])}return this},k.unhelper=function(a){var b=this._helpers;return b.hasOwnProperty(a)&&delete b[a],this},k.compile=function(a){var c=arguments[1];void 0===c&&(c={}),a=f(a);var d=m({},this.DEFAULTS,c),e=d.filename,g=!0===d.overwrite||this.$$cache(e);return b("Function")(g)?g:(g=this.$compile(a,d),b("String")(e)&&this.$$cache(e,g),g)},k.render=function(a){var b=arguments[1];void 0===b&&(b={});var c=arguments[2];return void 0===c&&(c={}),this.compile(a,c)(b)},g.extend=function(c){return b("Function")(c)&&a._extends.push(c),this},e(a,g),e(a.prototype,k),g=k=void 0,a}();q.ENV={PRODUCE:1,DEVELOP:2,UNIT:3},q.DEFAULTS={env:q.ENV.PRODUCE,noSyntax:!1,strict:!0,compress:!0,escape:!0,openTag:"{{",closeTag:"}}",depends:[]},q._extends=[],~m(q.prototype,{ENV:q.ENV,$$table:function(){function a(a,b){var c=arguments[2];void 0===c&&(c=" "),a=a.toString(),b=b.toString().replace(/\d/g,c);var d=b.split("");return d.splice(-a.length,a.length,a),d.join("")}return function(b,c){var d=arguments[2];void 0===d&&(d=c-3);var e=arguments[3];void 0===e&&(e=c+3);var f=0,g=b.match(/([^\n]*)?\n|([^\n]+)$/g);if(!g)return""+f+("|"+b);var h=g.length;return b.replace(/([^\n]*)?\n|([^\n]+)$/g,function(b){return f>=d&&e>=f?""+(f+1===c?">":" ")+(" "+a(++f,h))+("|"+b):""})}}(),$compileShell:function(){function c(a){var b=a.replace(/\\?\"([^\"])*\\?\"|\\?\'([^\'])*\\?\'|\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|\s*\.\s*[$\w\.]+/g,"").replace(/[^\w$]+/g,",").replace(/^\d[^,]*|,\d[^,]*|^,+|,+$/g,"").split(/^$|,+/);return l(b,function(a){return-1===c.KEYWORDS.indexOf(a)})}return c.KEYWORDS=["$scope","$helpers","$blocks","$data","$buffer","$runtime","$append","abstract","arguments","break","boolean","byte","case","catch","char","class","continue","console","const","debugger","default","delete","do","double","else","enum","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","undefined","var","void","volatile","while","with","yield"],function(e){var f=arguments[1];void 0===f&&(f={});var h=e,i=this.DEFAULTS,l=b("Boolean")(f.escape)?f.escape:i.escape,m=b("Boolean")(f.compress)?f.compress:i.compress,n=this._helpers,o=this._blockHelpers,p=this._sourceHelpers,q=[],r=[],s=[],t=1,u="",v=function(a){for(var b;b=/<%source\\s*([\w\W]+?)?\\s*%>(.+?)<%\/source%>/gim.exec(a);){var c=b[1],d=b[2];d=c&&p.hasOwnProperty(c)?p[c](d):d,d="<%=unescape('"+window.escape(d)+"')%>",a=a.replace(b[0],d)}return a},w=function(a){return a=a.replace(/<!--[\w\W]*?-->/g,"").replace(/^ +$/,""),""===a?"":(t+=a.split(/\n/).length-1,a=a.replace(/(["'\\])/g,"\\$1"),a=!0===m?a.replace(/[\r\t\n]/g,"").replace(/ +/g," "):a.replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n"),"$buffer+='"+a+"';")},x=function(e){return e=d(e||""),j(c(e),function(c){if(c){var d=a[c];if(!b("Function")(d)||!d.toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i))return b("Function")(n[c])?void q.push(c):b("Function")(o[c])?void r.push(c):void s.push(c)}}),/^=\s*[\w\W]+?\s*$/.exec(e)?e="$buffer+=$helpers.$toString("+e.replace(/[=\s;]/g,"")+(", "+l)+");":/^#\s*[\w\W]+?\s*$/.exec(e)?e="$buffer+=$helpers.$noescape("+e.replace(/[#\s;]/g,"")+");":/^!#\s*[\w\W]+?\s*$/.exec(e)?e="$buffer+=$helpers.$escape("+e.replace(/[!#\s;]/g,"")+");":/^\s*([\w\W]+)\s*\([^\)]*?\)\s*$/.exec(e)?e="$buffer+=$helpers.$toString("+e+(", "+l)+");":e+=";",t+=e.split(/\n|%0A/).length-1,e="$runtime="+t+(";"+e)+(""+(/\)$/.exec(e)?";":""))};return e=b("String")(e)?v(e):"",j(e.split("<%"),function(a){a=a.split("%>");var b=(c=[a[0],a[1]])[0],c=c[1];1===a.length?u+=w(b):(u+=x(b),u+=w(c))}),j(k(s),function(a){u="var "+a+("=$data."+a)+(";"+u)}),j(k(q),function(a){u="var "+a+("=$helpers."+a)+(";"+u)}),j(k(r),function(a){u="var "+a+("=$blocks."+a)+(";"+u)}),u='try {"use strict";var $scope=this,$helpers=$scope.$helpers,$blocks=$scope.$blocks,$buffer="",$runtime=0;'+u+"return $buffer;}catch(err) {throw {message: err.message,line: $runtime,"+("shell: '"+g(this.$$table(h))+"'")+"};}function $append(buffer) {$buffer += buffer;}"}}(),$compile:function(){return function(){function a(a){var c;try{c=new Function(h,k)}catch(f){d.$$throw({message:"[Compile Render]: "+f.message,line:"Javascript syntax occur error, it can not find out the error line.",syntax:d.$$table(e),template:b,shell:k}),c=o}return function(b){try{return c.apply(a,[b].concat(i))}catch(e){return e=m({},e,{source:d.$$table(a.$source,e.line)}),d.$$throw({message:"[Exec Render]: "+e.message,line:e.line,template:e.source,shell:d.$$table(e.shell,e.line)}),""}}}var b=arguments[0];void 0===b&&(b="");var c=arguments[1];void 0===c&&(c={});var d=this,e=b,f=m({},this.DEFAULTS,c),g=f.depends,h=["$data"].concat(g).join(","),i=[];~j(g,function(a){"$"===a.charAt(0)?(a=a.replace("$",""),i.push(f[a])):i.push(void 0)}),!0!==f.noSyntax&&(b=this.$compileSyntax(b,!!f.strict));var k=this.$compileShell(b,f);return a({$source:e,$helpers:this._helpers||{},$blocks:this._blockHelpers||{}})}}()}),q.DEFAULTS=m(q.DEFAULTS,{noSyntax:!1}),~m(q.prototype,{$$compile:function(a,c){return c=b("PlainObject")(c)?c:this.DEFAULTS,a.replace(/<%=\s*([^\s]+?)\s*%>/gim,function(a,b){return e(c,b)||""})},$$compileRegexp:function(a,b){var c=this.$$compile(a);return new RegExp(c,b)},$registerSyntax:function(a,c,d){var e=this;return 2<arguments.length?this._blocks[a]={syntax:b("RegExp")(c)?c:this.$$compileRegexp("<%= openTag %>"+c+"<%= closeTag %>","igm"),shell:b("Function")(d)?d:"<%"+this.$$compile(d)+"%>"}:b("PlainObject")(c)?j(c,function(b,c){e.$registerSyntax(a,c,b)}):b("Array")(c)&&j(c,function(c){b("String")(c.syntax)&&b("String")(c.shell)||b("Function")(c.shell)&&e.$registerSyntax(a,c.syntax,c.shell)}),this},$unregisterSyntax:function(a){var b=this._blocks;return b.hasOwnProperty(a)&&delete b[a],this},$clearSyntax:function(a){var b=this.$$compileRegexp("<%= openTag %>(.*)?<%= closeTag %>","igm");return a.replace(b,"")},$analyzeSyntax:function(a,b){var d=arguments[2];void 0===d&&(d="");var e=a;b&&j(this._blocks,function(a){e=e.replace(a.syntax,"")});var f=this.$$compileRegexp("<%= openTag %>|<%= closeTag %>","igm"),g=this.$clearSyntax(e),h=g.search(f);if(-1!==h){var i=c(g,h);return{message:"[Syntax Error]: Syntax error in line "+i+".",syntax:this.$$table(d,i)}}var k=this.$$compileRegexp("<%= openTag %>(.*)?<%= closeTag %>","igm"),l=a.match(k);if(l){h=e.search(k);var m=c(e,h);return{message:"[Syntax Error]: "+l[0]+(" did not match any syntax in line "+m)+".",syntax:this.$$table(e,m)}}return!0},$compileSyntax:function(a,b){b=!(!1===b);var c,d=a;this.DEFAULTS;return j(this._blocks,function(b){a=a.replace(b.syntax,b.shell)}),b?!0===(c=this.$analyzeSyntax(a,!1,d))?a:this.$$throw(c)||"":this.$clearSyntax(a)},block:function(a,c){if(1<arguments.length)b("String")(a)&&b("Function")(c)&&(this.$registerSyntax(""+a+"open","("+a+")\\s*(,?\\s*([\\w\\W]+?))\\s*(:\\s*([\\w\\W]+?))?\\s*",function(a,b,c,d,e,f){return"<%"+b+("($append, "+(c?c+", ":""))+("function ("+(f||""))+") {'use strict';var $buffer='';%>"}).$registerSyntax(""+a+"close","/"+a,"return $buffer;});")._blockHelpers[a]=function(a){var b=Array.prototype.splice.call(arguments,1);a(c.apply(this,b))});else{if(b("String")(a))return this._blockHelpers[a];if(b("PlainObject")(a))for(var d in a)this.block(d,a[d])}return this},unblock:function(a){var b=this._blockHelpers,c=this._blocks;return b.hasOwnProperty(a)&&(delete b[a],delete c[""+a+"open"],delete c[""+a+"close"]),this}}),q.extend(function(){var a="(!?#?)\\s*([^|]+?(?:\\s*(?:\\|\\||\\&\\&)\\s*[^|]+?)*)\\s*\\|\\s*([^:\\|]+?)\\s*(?:\\:\\s*([^\\|]+?))?\\s*(\\|\\s*[\\w\\W]+?)?",b=(this.$$compileRegexp(a),"\\s*([\\w\\W]+?\\s*\\([\\w\\W]+?\\))\\s*\\|\\s*([^:]+?)\\s*(:\\s*([^\\|]+?))?$"),c=this.$$compileRegexp(b);this.$registerSyntax("echo","=\\s*([\\w\\W]+?)\\s*","=$1").$registerSyntax("ifopen","if\\s*(.+?)\\s*","if($1) {").$registerSyntax("else","else","} else {").$registerSyntax("elseif","else\\s*if\\s*(.+?)\\s*","} else if($1) {").$registerSyntax("ifclose","\\/if","}").$registerSyntax("eachopen","each\\s*([\\w\\W]+?)\\s*(as\\s*(\\w*?)\\s*(,\\s*\\w*?)?)?\\s*",function(a,b,c,d,e){var f="each("+b+(", function("+(d||"$value"))+(""+(e||", $index"))+") {";return"<%"+f+"%>"}).$registerSyntax("eachclose","\\/each","})").$registerSyntax("include","include\\s*([\\w\\W]+?)\\s*(,\\s*[\\w\\W]+?)?\\s*",function(a,b,c){return"<%#include("+b+(""+(c||", $data"))+")%>"}).$registerSyntax("noescape","#\\s*([^|]+?)\\s*","#$1").$registerSyntax("escape","!#\\s*([^|]+?)\\s*","!#$1").$registerSyntax("helper",a,function(){function a(a,b,c,e,f,g){return""+e+("("+d(c))+(""+(f?","+f:""))+(")"+(g?g.replace(/^\s*$/,""):""))}function b(a,b,c,d,e){return""+c+("("+b)+(","+e)+")"}return function(d,e,g,h,i,j){for(var k=a.apply(this,arguments);c.exec(k);)k=k.replace(c,b);return"<%"+f(e)+(""+k)+"%>"}}()).$registerSyntax("logic","-\\s*(.+?)\\s*","$1"),~m(this._helpers,{each:function(a,b){j(a,b)}})});require("fs");h.SOURCES={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},h.escapeFn=function(a){return h.SOURCES[a]},p("oTemplate",function(){return new q},a)}(this);
//# sourceMappingURL=oTemplate.min.js.map