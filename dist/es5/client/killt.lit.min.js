// killt.min.js#1.0.4-beta - 2016-05-14 16:03:16
"use strict";function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},_slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();~function(){function a(b){return function(c){switch(b){case"Undefined":return"undefined"==typeof c;case"Defined":return"undefined"!=typeof c;case"Integer":var d=parseInt(c,10);return!isNaN(d)&&c===d&&c.toString()===d.toString();case"PlainObject":var e=void 0,f=void 0;return!1===a("Object")(c)||a("Undefined")(c)?!1:(e=c.constructor,"function"!=typeof e?!1:(f=e.prototype,!1===a("Object")(f)?!1:!1!==f.hasOwnProperty("isPrototypeOf")));default:return"[object "+b+"]"===Object.prototype.toString.call(c)}}}function b(a,b){return(a.substr(0,b).match(/\n/g)||[]).length+1}function c(a){return e(a).replace(/^\s+|\s+$/,"")}function d(b,c){var d=arguments.length<=2||void 0===arguments[2]?".":arguments[2];if(a("String")(c)){for(var e=b,f=c.split(d),g=0,h=f.length;h>g;g++){if(a("Undefined")(e[f[g]]))return;e=e[f[g]]}return a("Undefined")(e)?void 0:e}}function e(b){return a("String")(b)?b:a("Number")(b)?b+="":a("Function")(b)?e(b.call(b)):""}function f(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return a.replace(/("|'|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")}function g(a){return e(a).replace(/&(?![\w#]+;)|[<>"']/g,function(a){return g.SOURCES[a]})}function h(b,c){if(Array.prototype.indexOf&&a("Function")(b.indexOf))return b.indexOf(c);for(function(){b.length}();i<l;i++)if(b[i]===c)return i;return-1}function j(b,c,d){var e=a("Object")(c)?c[d]:c;for(function(){b.length}();i<l;i++)if(e==b[i][d])return i;return-1}function k(b,c){if(a("Function")(c))if(a("Array")(b))if(Array.prototype.some)b.some(c);else for(function(){b.length}();i<l&&!0!==c(b[i],i);i++);else if(a("Object")(b))for(var d in b)if(!0===c(b[d],d))break}function m(a){for(var b={},c=[],d=a.length;d--;)b.hasOwnProperty(a[d])||(c.push(a[d]),b[a[d]]=1);return c}function n(b,c){var d=a("Array")(b),e=d?[]:{};return k(b,function(a,b){c(a,b)&&(e[d?e.length:b]=a)}),e}function o(){for(var b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];var e=c[0],f=c[1];if(2<c.length){e=o(e,f);var g=Array.prototype.slice.call(c,2);return o.apply({},[e].concat(g))}if(a("Array")(e)&&a("Array")(f))Array.prototype.splice.apply(e,[e.length,0].concat(f));else if(a("Object")(e)&&a("Object")(f))if(a("Function")(Object.assign))e=Object.assign(e,f);else for(var h in f)e[h]=f[h];return e}function p(b){var c=[];a("Object")(b)?k(b,function(a,b){c.push("<"+b.substr(0,1).toUpperCase()+b.substr(1)+">"),c.push("\n"),c.push(a),c.push("\n\n")}):a("String")(b)&&(c=b);try{console.error.apply(console,c)}catch(d){setTimeout(function(){throw c})}return c}function q(){return""}function r(b,c,d){var e=d.define,f=c(d);a("Function")(e)?e(function(){return f}):d[b]=f}function s(a,b){var c=document.createElement("div");c.innerHTML=b;for(var d=c.getElementsByTagName("script"),e=d.length;e--;)if(a===d[e].id)return d[e].innerHTML}var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];g.SOURCES={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"};var u={PRODUCE:1,DEVELOP:2,UNITEST:3},v={env:u.PRODUCE,noSyntax:!0,strict:!0,escape:!0,compress:!0,depends:[]},w=[],x=["$append","$blocks","$buffer","$data","$helpers","$scope","$runtime","abstract","arguments","break","boolean","byte","case","catch","char","class","continue","console","const","debugger","default","delete","do","double","else","enum","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","undefined","var","void","volatile","while","with","yield"],y=function(){function b(){var c=this,d=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,b),this._caches={},this._blocks={},this._blockHelpers={},this._sourceHelpers={},this._helpers={$escape:function(){return g.apply(g,arguments)},$noescape:function(a){return e(a)},$toString:function(a,b){return a=e(a),b?this.$escape(a):a}},this._listeners=[],this.setting=o({},v),this.setting=o(this.setting,d),a("Array")(w)&&0<w.length&&k(w,function(a){c["extends"](a)})}return _createClass(b,[{key:"options",value:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return o.apply({},[{},this.setting].concat(b))}},{key:"config",value:function(b,c){var d=this;return 1<arguments.length&&a("String")(b)?"openTag"===b&&"<%"===b||"closeTag"===b&&"%>"===b?this:(this.setting[b]=c,this):a("PlainObject")(b)?(k(b,function(a,b){d.config(a,b)}),this):a("String")(b)?this.setting[b]:void 0}},{key:"$compileShell",value:function(){var b=this,d=arguments.length<=0||void 0===arguments[0]?"":arguments[0],e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],g=d,h=this.options(e),i=!!h.escape,j=!!h.compress,l=this._helpers,o=this._blockHelpers,p=this._sourceHelpers,q=[],r=[],s=[],u=1,v="",w=function(a){var b=a.replace(/\\?\"([^\"])*\\?\"|\\?\'([^\'])*\\?\'|\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|\s*\.\s*[$\w\.]+/g,"").replace(/[^\w$]+/g,",").replace(/^\d[^,]*|,\d[^,]*|^,+|,+$/g,"").split(/^$|,+/);return n(b,function(a){return-1===x.indexOf(a)})},y=function(a){for(var c=void 0;c=/<%source\\s*([\w\W]+?)?\\s*%>(.+?)<%\/source%>/gim.exec(a);){var d=c,f=_slicedToArray(d,3),g=f[0],h=f[1],i=f[2];h&&p.hasOwnProperty(h)&&(i=p[h](i,e,b)),i="<%=unescape('"+escape(i)+"')%>",a=a.replace(g,i)}return a},z=function(a){return""===a.replace(/<!--[\w\W]*?-->/g,"").replace(/^ +$/,"")?"$buffer+='"+a+"';":(u+=a.split(/\n/).length-1,a=a.replace(/(["'\\])/g,"\\$1"),a=!0===j?a.replace(/<!--[\w\W]*?-->/g,"").replace(/[\r\t\n]/g,"").replace(/ +/g," "):a.replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n"),"$buffer+='"+a+"';")},A=function(b){return b=c(b||""),k(w(b),function(b){if(b){var c=t[b];if(!a("Function")(c)||!c.toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i))return a("Function")(l[b])?void q.push(b):a("Function")(o[b])?void r.push(b):void s.push(b)}}),/^=\s*[\w\W]+?\s*$/.exec(b)?b="$buffer+=$helpers.$toString("+b.replace(/^=|;$/g,"")+", !!"+i+");":/^#\s*[\w\W]+?\s*$/.exec(b)?b="$buffer+=$helpers.$noescape("+b.replace(/^#|;$/g,"")+");":/^!#\s*[\w\W]+?\s*$/.exec(b)?b="$buffer+=$helpers.$escape("+b.replace(/^!#|;$/g,"")+");":/^\s*([\w\W]+)\s*\([^\)]*?\)\s*$/.exec(b)?b="$buffer+=$helpers.$toString("+b+", !!"+i+");":b+=";",u+=b.split(/\n|%0A/).length-1,b="$runtime="+u+";"+b+(/\)$/.exec(b)?";":"")};return d=y(d),k(d.split("<%"),function(a){a=a.split("%>");var b=a[0],c=a[1];1===a.length?v+=z(b):(v+=A(b),v+=z(c))}),k(m(s),function(a){v="var "+a+"=$data."+a+";"+v}),k(m(q),function(a){v="var "+a+"=$helpers."+a+";"+v}),k(m(r),function(a){v="var "+a+"=$blocks."+a+";"+v}),v='try {"use strict";var $scope=this,$helpers=$scope.$helpers,$blocks=$scope.$blocks,$buffer="",$runtime=0;'+v+"return $buffer;}catch(err) {throw {message: err.message,line: $runtime,"+("shell: '"+f(g)+"',")+"args: arguments};}function $append(buffer) {$buffer += buffer;}"}},{key:"$compile",value:function(){var a=this,b=arguments.length<=0||void 0===arguments[0]?"":arguments[0],c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],d=b,e=this.options(c),f=!!e.compress,g=e.depends,h=["$data"].concat(g),i=[];~k(g,function(a){"$"===a.charAt(0)?(a=a.replace("$",""),i.push(e[a])):i.push(void 0)}),!1===f&&(b=b.replace(/<!--([\w\W]+?)-->/g,function(a,b){return"<!--"+escape(b)+"-->"})),!0!==e.noSyntax&&(b=this.$compileSyntax(b,!!e.strict));var j=this.$compileShell(b,e),l=function(e){var g=void 0,l=function(b){var d={message:"[Exec Render]: "+b.message,template:c.filename,line:b.line,source:a._table(e.$source,b.line),shell:a._table(b.shell,b.line)};return k(h,function(a,c){d["arguments:"+a]=b.args[c]}),a._throw(d),""};try{g=new Function(h.join(","),j)}catch(m){a._throw({message:"[Compile Render]: "+m.message,template:c.filename,line:"Javascript syntax occur error, it can not find out the error line.",syntax:a._table(d),source:b,shell:j}),g=q}return!1===f?function(a){try{var b=g.apply(e,[a].concat(i));return b.replace(/<!--([\w\W]+?)-->/g,function(a,b){return"<!--"+unescape(b)+"-->"})}catch(c){return l(c)}}:function(a){try{return g.apply(e,[a].concat(i))}catch(b){return l(b)}}};return l({$source:d,$helpers:this._helpers||{},$blocks:this._blockHelpers||{}})}},{key:"compile",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];b=e(b);var d=this.options(c),f=d.filename,g=!0===d.override||this._cache(f);return a("Function")(g)?g:(g=this.$compile(b,d),a("String")(f)&&this._cache(f,g),g)}},{key:"render",value:function(a){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],d=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];return b.prototype.compile.call(this,a,d)(c)}},{key:"helper",value:function(b,c){if(1<arguments.length)a("String")(b)&&a("Function")(c)&&(this._helpers[b]=c);else{if(a("String")(b))return this._helpers[b];if(a("PlainObject")(b))for(var d in b)this.helper(d,b[d])}return this}},{key:"unhelper",value:function(a){var b=this._helpers;return b.hasOwnProperty(a)&&delete b[a],this}},{key:"on",value:function(b,c){return a("String")(b)&&a("Function")(c)&&this._listeners.push({type:b,handle:c}),this}},{key:"off",value:function(b){if(a("Function")(b)){var c=j(this._listeners,b,"handle");-1!==c&&this._listeners.splice(c,1)}return this}},{key:"onError",value:function(a){return this.on("error",a)}},{key:"extends",value:function(a){return a.call(this,this),this}},{key:"_throw",value:function(a){var b=this,c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],d=this.options(c);-1===h([u.UNITEST,u.PRODUCT],d.env)&&!function(){var c=p(a);k(b._listeners,function(b){"error"===b.type&&b.handle(a,c)})}()}},{key:"_cache",value:function(a,b){var c=this._caches;return 1<arguments.length?(c[a]=b,this):c[a]}},{key:"_table",value:function(a,b){var c=0,d=a.match(/([^\n]*)?\n|([^\n]+)$/g);if(!d)return"> "+c+"|"+a;var e=d.length,f=0,g=e;b>0&&e>b&&(f=b-3,g=b+3);var h=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?" ":arguments[2];a=a.toString(),b=b.toString().replace(/\d/g,c);var d=b.split("");return d.splice(0-a.length,a.length,a),d.join("")};return a.replace(/([^\n]*)?\n|([^\n]+)$/g,function(a){return++c,c>=f&&g>=c?c===b?"> "+h(c,e)+"|"+a:"  "+h(c,e)+"|"+a:""})}},{key:"$divide",value:function(a){return new this.constructor(a)}},{key:"$compileSyntax",value:function(){throw new Error("Function `$compileSyntax` does not be implemented.")}},{key:"ENV",get:function(){return u}}],[{key:"extend",value:function(b){return a("Function")(b)&&w.push(b),this}}]),b}();o(v,{openTag:"{{",closeTag:"}}",noSyntax:!1});var z=function(c){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,Object.getPrototypeOf(e).apply(this,arguments))}return _inherits(e,c),_createClass(e,[{key:"_compile",value:function(b,c){return c=a("PlainObject")(c)?c:this.setting,b.replace(/<%=\s*([^\s]+?)\s*%>/gim,function(a,b){return d(c,b)||""})}},{key:"_compileRegexp",value:function(a,b){var c=this._compile(a);return new RegExp(c,b)}},{key:"_compileSyntax",value:function(a){var c=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],d=arguments.length<=2||void 0===arguments[2]?a:arguments[2],e=!1;if(k(this._blocks,function(b){var c=a.replace(b.syntax,b.shell);return c!==a?(a=c,e=!0,!0):void 0}),!1===e){var f=d.search(a),g=b(d,f);return this._throw({message:"[Syntax Error]: "+a+" did not match any syntax in line "+g+".",syntax:this._table(d,g)}),!0===c?!1:""}return a}},{key:"$compileSyntax",value:function(a){function c(a){return a.replace(/<%/g,"&lt;%").replace(/%>/g,"%&gt;")}var d=this,e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],f=a,g=this.options(),h=void 0;if(a=c(a),k(a.split(g.openTag),function(b){var c=b.split(g.closeTag);return 1!==c.length&&(a=a.replace(""+g.openTag+c[0]+g.closeTag,function(a){return h=d._compileSyntax(a,e,f)})),!1===h?(a="",!0):void 0}),""===a)return"";var i=this._compileRegexp("<%= openTag %>|<%= closeTag %>","igm"),j=a.search(i);if(-1!==j){if(!0===e){var l=b(a,j);return this._throw({message:"[Syntax Error]: Syntax error in line "+l+".",syntax:this._table(f,l)}),""}return this.$clearSyntax(a)}return a}},{key:"$clearSyntax",value:function(a){var b=this._compileRegexp("<%= openTag %>(.*)?<%= closeTag %>","igm");return a.replace(b,"")}},{key:"$registerSyntax",value:function(b,c,d){var e=this;return 2<arguments.length?this._blocks[b]={syntax:a("RegExp")(c)?c:this._compileRegexp("<%= openTag %>"+c+"<%= closeTag %>","igm"),shell:a("Function")(d)?d:"<%"+this._compile(d)+"%>"}:a("PlainObject")(c)?k(c,function(a,c){e.$registerSyntax(b,c,a)}):a("Array")(c)&&k(c,function(c){a("String")(c.syntax)&&(a("String")(c.shell)||a("Function")(c.shell))&&e.$registerSyntax(b,c.syntax,c.shell)}),this}},{key:"$unregisterSyntax",value:function(a){var b=this._blocks;return b.hasOwnProperty(a)&&(b[a]=void 0,delete b[a]),this}},{key:"block",value:function(b,c){if(1<arguments.length)a("String")(b)&&a("Function")(c)&&(this.$registerSyntax(b+"open","("+b+")\\s*(,?\\s*([\\w\\W]+?))\\s*(:\\s*([\\w\\W]+?))?\\s*",function(a,b,c,d,e,f){return"<%"+b+"($append, "+(c?c+", ":"")+"function ("+(f||"")+") {'use strict';var $buffer='';%>"}).$registerSyntax(b+"close","/"+b,"return $buffer;});"),this._blockHelpers[b]=function(a){var b=Array.prototype.splice.call(arguments,1);a(c.apply(this,b))});else{if(a("String")(b))return this._blockHelpers[b];if(a("PlainObject")(b))for(var d in b)this.block(d,b[d])}return this}},{key:"unblock",value:function(a){var b=this._blockHelpers,c=this._blocks;return b.hasOwnProperty(a)&&(b[a]=void 0,c[a+"open"]=void 0,c[a+"close"]=void 0,delete b[a],delete c[a+"open"],delete c[a+"close"]),this}}]),e}(y),A=function(b){function c(a){_classCallCheck(this,c);var b=_possibleConstructorReturn(this,Object.getPrototypeOf(c).call(this,a));return~o(b._helpers,{include:function(a,c,d){return b.renderSync(a,c,d)}}),b}return _inherits(c,b),_createClass(c,[{key:"compileSource",value:function(a,b){return _get(Object.getPrototypeOf(c.prototype),"compile",this).call(this,a,b)}},{key:"renderSource",value:function(a,b,d){return _get(Object.getPrototypeOf(c.prototype),"render",this).call(this,a,b,d)}},{key:"compile",value:function(b,c){var d=this,f=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];b=e(b);var g=this.options(f,{filename:b}),h=!0===g.override?void 0:this._cache(b);if(a("Function")(h))return void c(null,h);var i=document.getElementById(b);if(i){var j=i.innerHTML.replace(/^ *\n|\n *$/g,"");return h=this.compileSource(j,g),void c(null,h)}this.readFileByAJAX(b,function(a,e){if(a)return void c(a);var f=[],h=e;if(!1===g.noSyntax&&(e=d.$compileSyntax(e,g.strict)),k(e.split("<%"),function(a){var b=[a.split("%>")],c=b[0],d=b[1];1!==c.length&&(d=/include\s*\(\s*([\w\W]+?)(\s*,\s*([^\)]+)?)?\)/.exec(c[0]))&&f.push(d[1].replace(/[\'\"\`]/g,""))}),0<f.length)!function(){var a=[];if(k(f,function(b){if(!d._cache(b)){var c=s(b,h);if(c)d.compileSource(c,{filename:b,override:!!g.override});else{var e=new Promise(function(a,c){d.compile(b,function(b,d){b?c(b):a(d)},g)});a.push(e)}}}),0<a.length)Promise.all(a).then(function(){var a=d.$compile(h);d._cache(b,a),c(null,a)})["catch"](function(a){c(a)});else{var e=d.$compile(h);d._cache(b,e),c(null,e)}}();else{var i=d.$compile(h);d._cache(b,i),c(null,i)}},o(g,{sync:!1}))}},{key:"render",value:function(b,c,d){var e=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];a("Function")(c)?this.render(b,{},c,d):a("Function")(d)&&this.compile(b,function(a,b){d(a,b(c||{}))},e)}},{key:"compileSync",value:function(b){var c=this,d=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];b=e(b);var f=this.options(d,{filename:b}),g=!0===f.override?void 0:this._cache(b);if(a("Function")(g))return g;var h=document.getElementById(b);if(h){var i=h.innerHTML.replace(/^ *\n|\n *$/g,"");return this.compileSource(i,f)}var j=this.readFileByAJAX(b,null,o(f,{sync:!1}));if(a("Undefined")(j))return q;var l=[],m=j;return!1===f.noSyntax&&(j=this.$compileSyntax(j,f.strict)),k(j.split("<%"),function(a){var b=[a.split("%>")],c=b[0],d=b[1];1!==c.length&&(d=/include\s*\(\s*([\w\W]+?)(\s*,\s*([^\)]+)?)?\)/.exec(c[0]))&&l.push(d[1].replace(/[\'\"\`]/g,""))}),0<l.length&&k(l,function(a){c._cache(a)||c.compileSync(a,d)}),g=this.$compile(m),this._cache(b,g),g}},{key:"renderSync",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],c=arguments[2],d=this.compileSync(a,c);return d(b)}},{key:"readFileByAJAX",value:function(b,c){var d=this,e=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];a("Function")(c)||(c=function(){});var f=new XMLHttpRequest,g=void 0;return f.onreadystatechange=function(){var a=this.status;this.DONE===this.readyState&&a>=200&&400>a&&(g=this.responseText,c(null,this.responseText))},f.onerror=function(){var a={message:"[Compile Template]: Request file "+b+" some error occured.",filename:b,response:"[Reponse State]: "+d.status};d._throw(a),c(a)},f.ontimeout=function(){var a={message:"[Request Template]: Request template file "+b+" timeout.",filename:b};d._throw(a),c(a)},f.onabort=function(){var a={message:"[Request Template]: Bowswer absort the request.",filename:b};d._throw(a),c(a)},f.open("GET",b,!e.sync),f.send(null),g}}]),c}(z||y);r("killt",function(){return new A},t)}("undefined"==typeof global?"undefined"==typeof window?{}:window:global);
//# sourceMappingURL=killt.lit.min.js.map